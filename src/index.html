<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="node_modules/uikit/dist/css/uikit.min.css">
    <script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>
    <title>Apka</title>
</head>

<body>

    <div class="uk-container-fluid">
        <div class="uk-card uk-card-body uk-card-primary">
            <h3 class="uk-card-title">Log in via Google. Status:
                <span id="logInfo"></span>
            </h3>

            <button class="uk-button uk-button-default" id="googleLogIn">LogIn</button>
            <button class="uk-button uk-button-default" id="googleLogOut">LogOut</button>
            <button class="uk-button uk-button-default" id="googleCheck">Check if logged in</button>
        </div>
    </div>

    <script>
        // Initialize Firebase
        firebase.initializeApp({
            apiKey: "AIzaSyDegpZHnxLGjBt21vzo2Gvfl_e9I670tv4",
            authDomain: "habitlogger-b5990.firebaseapp.com",
            databaseURL: "https://habitlogger-b5990.firebaseio.com",
            projectId: "habitlogger-b5990",
            storageBucket: "",
            messagingSenderId: "276150810360"
        });


        const provider = new firebase.auth.GoogleAuthProvider();

        const hLogInfo = document.querySelector('#logInfo');

        document.querySelector('#googleLogIn').addEventListener('click', function () {
            firebase.auth().signInWithPopup(provider).then(function (result) {
                // This gives you a Google Access Token. You can use it to access the Google API.
                var token = result.credential.accessToken;
                // The signed-in user info.
                var user = result.user;
                console.log(user);
                // ...
            }).catch(function (error) {
                // Handle Errors here.
                var errorCode = error.code;
                var errorMessage = error.message;
                // The email of the user's account used.
                var email = error.email;
                // The firebase.auth.AuthCredential type that was used.
                var credential = error.credential;
                console.log(error);
                // ...
            });
        });

        document.querySelector('#googleLogOut').addEventListener('click', function () {
            firebase.auth().signOut().then(function () {
                // Sign-out successful.
            }).catch(function (error) {
                // An error happened.
            });
        });

        firebase.auth().onAuthStateChanged(function (user) {
            if (user) {
                hLogInfo.textContent = "Zalogowany";
                console.log(user);
            } else {
                hLogInfo.textContent = "Niezalogowany";
            }
        });

        document.querySelector('#googleCheck').addEventListener('click', function () {
            var user = firebase.auth().currentUser;

            if (user) {
                alert("Jestem zalogowany, hy hy.");
            } else {
                alert("Nie jestem zalogowany, wut.");
            }
        });
    </script>
</body>

</html>